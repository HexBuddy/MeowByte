# Toolset for Web Attacks and Exploitation

### Welcome to the second chapter, where we will prepare our means of attacking web applications, starting with our first Capture the Flag (CTF) exercise.

{% hint style="info" %}
### For This Chapter ( Also For the Rest of the notes ) I will assume that you have familiarity  with basic linux commands + installed Burp suite.
{% endhint %}

### For The Sake Of my Notes I will be using the OS am using currently which is Garuda Linux ( Arch Based )&#x20;

1. Open The Browser In Burp

<figure><img src="../../.gitbook/assets/image.png" alt=""><figcaption></figcaption></figure>

2. We can type [https://onofri.org/ctf](https://onofri.org/ctf) in the address bar and hit Enter.
3. The page then opens with a GIF of Gandalf – a famous Lord of the Rings character – quoting from the first movie, The Fellowship of the Ring, saying You shall not pass!.

<figure><img src="../../.gitbook/assets/image (2).png" alt=""><figcaption></figcaption></figure>

4. Start by inspecting the page source in Burp Suite's HTTP history tab under Proxy. This tab lists all HTTP requests with details like request number, host, HTTP method, URL, parameters, modifications, server response status, content length, MIME type, and more.

<figure><img src="../../.gitbook/assets/image (3).png" alt=""><figcaption></figcaption></figure>

5. Let us analyze the server’s response; double-click the line in the history where we have a 200 status. If you need clarification on the meaning of 200, refer to [RFC 9110](https://www.rfc-editor.org/rfc/rfc9110). Then, on the screen that opens, click on Response. Let us begin with the headers. Inside the X-Ua-Compatible header, we can read `WEBEXP{head_and_brain_are_your_best_tools}`; this is our first flag! This also reminds us of what we learned in the first chapter – that our best tool is our mind and that our mindset is essential.

<figure><img src="../../.gitbook/assets/image (4).png" alt=""><figcaption></figcaption></figure>

6. To quickly search for whether there are other flags, we can use the search bar at the bottom. Position yourself there with your cursor and type WEBEXP without quotes. As you can see, there are two matches – one is the header we already saw. Click on the arrow pointing to the right to go to the second match instantly. You have found the second flag, even though it was hidden deep in an HTML comment, with one click.

<figure><img src="../../.gitbook/assets/image (5).png" alt=""><figcaption></figcaption></figure>

7. In addition to the browser, we can use Burp’s Repeater tool to repeat requests without rewriting them from scratch. Pass a request to the repeater by right-clicking and selecting Send to Repeater, or use Ctrl + R.

<figure><img src="../../.gitbook/assets/image (6).png" alt=""><figcaption></figcaption></figure>

8. The Repeater tool is where we usually spend a lot of our time. It allows us to make requests and observe the responses. Each request has a tab, which we can rename to keep everything in order. Our purpose is to find other pages in the CTF exercise. In a web application, additional URLs are usually found in the robots.txt file. If you want to know more about robots. txt, you can start with the recommendation on HTML4 from the World Wide Web Consortium (W3C). \
   To request the Repeater tool, we add the `robots.txt` file to `/ctf/`, being mindful of spaces and newlines to avoid breaking the HTTP syntax. Then, click on Send.

<figure><img src="../../.gitbook/assets/image (7).png" alt=""><figcaption></figcaption></figure>

9. As we can see from , the robots.txt file gave us different information and more URLs to try. We should also note an interesting thing in line 11 of the response (including the headers) – a comment (since it starts with #) with a string ending in ==. Most likely, it is a Base64 \[25]. To check, select the text, right-click, and then choose Send to Decoder. As we can see, in the Inspector window on the right, Burp has already done the decoding.

<figure><img src="../../.gitbook/assets/image (8).png" alt=""><figcaption></figcaption></figure>

10. Click on the Decoder tab, where you can find the sent string. Choose to decode from the menu on the right by clicking on Decode as... and selecting Base64. In the Decoder screen, the decoded input in Base64 will appear. As we can see, we have found a new flag.

<figure><img src="../../.gitbook/assets/image (9).png" alt=""><figcaption></figcaption></figure>

11. Of course, besides using the repeater to make requests, we can intercept them from the browser and modify them on the fly. To try this feature, you can turn it on by going to Proxy and then Intercept and clicking on the Intercept is off button to turn Intercept on.

<figure><img src="../../.gitbook/assets/image (10).png" alt=""><figcaption></figcaption></figure>

12. Then, go to Chromium, type in [https://onofri.org/ctf/,](https://onofri.org/ctf/,) and press Enter. You will see Chromium loading. If we wait, nothing happens, and the request remains “hanging.” Why? The internet did not break, but Burp intercepted the request and waited for us to forward it.

<figure><img src="../../.gitbook/assets/image (11).png" alt=""><figcaption></figcaption></figure>

13. Then, go back to Burp, where you will find the request loading on the Proxy and Intercept screens. You can forward it or discard it and edit it on the fly. In this case, we will change the URL to `/ctf/admin` (since admin pages often have a similar URL) and click Forward.

<figure><img src="../../.gitbook/assets/image (12).png" alt=""><figcaption></figcaption></figure>

14. Wait for the server to respond and – if necessary – confirm the further redirection. When there are no pending requests in the intercept, you can turn it off and return to Chromium. We got lucky, so Chromium showed us a friendly login page.

<figure><img src="../../.gitbook/assets/image (13).png" alt=""><figcaption></figcaption></figure>

This introduction to a CTF exercise demonstrated the basic functionalities of Burp. There are many more features that we will see as we go along. If you want to go deeper, then go ahead and continue the CTF exercise. There are several flags to be found! If you need to learn more about using Burp, an essential guide is available on the [official website](https://portswigger.net/burp/documentation).
